unit uTelaHeranca;

interface

uses
  Winapi.Windows, Winapi.Messages, System.SysUtils, System.Variants, System.Classes, Vcl.Graphics,
  Vcl.Controls, Vcl.Forms, Vcl.Dialogs, Vcl.ComCtrls, Vcl.ExtCtrls, Data.DB,
  Vcl.Buttons, Vcl.DBCtrls, Vcl.Grids, Vcl.DBGrids, Vcl.StdCtrls, Vcl.Mask,
  System.Actions, Vcl.ActnList, System.ImageList, Vcl.ImgList, Data.Win.ADODB, uEnum;

type
  TfTelaHeranca = class(TForm)
    pnlBotoes: TPanel;
    pgPrincipal: TPageControl;
    tabListagem: TTabSheet;
    tabManutencao: TTabSheet;
    pnlBotoesListagem: TPanel;
    dbgListagem: TDBGrid;
    btnNavigator: TDBNavigator;
    pnlNovo: TPanel;
    pnlEspaco: TPanel;
    pnlAlterar: TPanel;
    pnlEspaco2: TPanel;
    pnlCancelar: TPanel;
    pnlEspaco3: TPanel;
    pnlGravar: TPanel;
    pnlEspaco4: TPanel;
    pnlApagar: TPanel;
    pnlEspaco5: TPanel;
    btnNovo: TSpeedButton;
    imgImagens: TImageList;
    ActionList1: TActionList;
    btnAlterar: TSpeedButton;
    btnCancelar: TSpeedButton;
    btnGravar: TSpeedButton;
    btnApagar: TSpeedButton;
    pnlEspaco6: TPanel;
    pnlEspaco7: TPanel;
    pnlFechar: TPanel;
    pnlEspaco8: TPanel;
    btnFechar: TSpeedButton;
    pnlEspaco9: TPanel;
    pnlPesquisar: TPanel;
    edtPesquisar: TMaskEdit;
    pnlPesquisarr: TPanel;
    btnPesquisar: TSpeedButton;
    novo: TAction;
    alterar: TAction;
    Cancelar: TAction;
    gravar: TAction;
    apagar: TAction;
    Fechar: TAction;
    Pesquisar: TAction;
    lblIndice: TLabel;
    procedure btnNovoMouseEnter(Sender: TObject);
    procedure btnNovoMouseLeave(Sender: TObject);
    procedure btnAlterarMouseEnter(Sender: TObject);
    procedure btnAlterarMouseLeave(Sender: TObject);
    procedure btnCancelarMouseEnter(Sender: TObject);
    procedure btnCancelarMouseLeave(Sender: TObject);
    procedure btnGravarMouseEnter(Sender: TObject);
    procedure btnGravarMouseLeave(Sender: TObject);
    procedure btnApagarMouseEnter(Sender: TObject);
    procedure btnApagarMouseLeave(Sender: TObject);
    procedure btnFecharMouseEnter(Sender: TObject);
    procedure btnFecharMouseLeave(Sender: TObject);
    procedure btnPesquisarMouseEnter(Sender: TObject);
    procedure btnPesquisarMouseLeave(Sender: TObject);
    procedure btnFecharClick(Sender: TObject);
    procedure btnNovoClick(Sender: TObject);
    procedure btnCancelarClick(Sender: TObject);
    procedure btnGravarClick(Sender: TObject);
    procedure btnApagarClick(Sender: TObject);
    procedure btnAlterarClick(Sender: TObject);
    procedure dbgListagemTitleClick(Column: TColumn);
  private
    EstadoDoCadastro : TEstadoDoCadastro;
    procedure ControlarBotoes(btnNovo, btnAlterar, btnCancelar, btnGravar, btnApagar: TSpeedButton; Navegador: TDBNavigator; pgcPrincipal: TPageControl; Flag: Boolean);
    procedure ControlarIndiceTab(pgcPrincipal: TPageControl; indice: integer);
    { Private declarations }
  public
    { Public declarations }
    IndiceAtual: String;
  end;

var
  fTelaHeranca: TfTelaHeranca;

implementation

{$R *.dfm}

uses uDM, uCadCategoria, uPrincipal;

procedure TfTelaHeranca.btnAlterarClick(Sender: TObject);
begin
  ControlarBotoes(btnNovo, btnAlterar, btnCancelar, btnGravar, btnApagar, btnNavigator, pgPrincipal, false);
  EstadoDoCadastro :=  ecAlterar;
end;

procedure TfTelaHeranca.btnAlterarMouseEnter(Sender: TObject);
begin
  btnAlterar.Caption := 'Alterar';
end;

procedure TfTelaHeranca.btnAlterarMouseLeave(Sender: TObject);
begin
  btnAlterar.Caption := '';
end;

procedure TfTelaHeranca.btnApagarClick(Sender: TObject);
begin
  ControlarBotoes(btnNovo, btnAlterar, btnCancelar, btnGravar, btnApagar, btnNavigator, pgPrincipal, true);
  ControlarIndiceTab(pgPrincipal, 0);
  EstadoDoCadastro := ecNenhum;
end;

procedure TfTelaHeranca.btnApagarMouseEnter(Sender: TObject);
begin
  btnApagar.Caption := 'Apagar';
end;

procedure TfTelaHeranca.btnApagarMouseLeave(Sender: TObject);
begin
  btnApagar.Caption := '';
end;

procedure TfTelaHeranca.btnCancelarClick(Sender: TObject);
begin
  ControlarBotoes(btnNovo, btnAlterar, btnCancelar, btnGravar, btnApagar, btnNavigator, pgPrincipal, true);
  ControlarIndiceTab(pgPrincipal, 0);
  EstadoDoCadastro := ecNenhum;
end;

procedure TfTelaHeranca.btnCancelarMouseEnter(Sender: TObject);
begin
  btnCancelar.Caption := 'Cancelar';
end;

procedure TfTelaHeranca.btnCancelarMouseLeave(Sender: TObject);
begin
  btnCancelar.Caption := '';
end;

procedure TfTelaHeranca.btnFecharClick(Sender: TObject);
begin
  self.Release;
end;

procedure TfTelaHeranca.btnFecharMouseEnter(Sender: TObject);
begin
  btnFechar.Caption := 'Fechar';
end;

procedure TfTelaHeranca.btnFecharMouseLeave(Sender: TObject);
begin
  btnFechar.Caption := '';
end;

procedure TfTelaHeranca.btnGravarClick(Sender: TObject);
begin
  Try
    ControlarBotoes(btnNovo, btnAlterar, btnCancelar, btnGravar, btnApagar, btnNavigator, pgPrincipal, true);
    ControlarIndiceTab(pgPrincipal, 0);

    if (EstadoDoCadastro = ecInserir) then
        ShowMessage('Inserido')
    Else if (EstadoDoCadastro = ecAlterar)  then
        ShowMessage('Alterado')
    Else
        ShowMessage('Nada Aconteceu');


  Finally
    EstadoDoCadastro := ecNenhum;
  End;
end;

// toda vez que clicar no botão vai aparecer gravar
procedure TfTelaHeranca.btnGravarMouseEnter(Sender: TObject);
begin
  btnGravar.Caption := 'Gravar';
end;

// Após remover o mouse do botão, ele retornar como estava antes, no botão só vai ter a imagem
procedure TfTelaHeranca.btnGravarMouseLeave(Sender: TObject);
begin
  btnGravar.Caption := '';
end;

procedure TfTelaHeranca.btnNovoClick(Sender: TObject);
begin
  ControlarBotoes(btnNovo, btnAlterar, btnCancelar, btnGravar, btnApagar, btnNavigator, pgPrincipal, false);
  EstadoDoCadastro := ecInserir;
end;

procedure TfTelaHeranca.btnNovoMouseEnter(Sender: TObject);
begin
  btnNovo.Caption := 'Novo';
end;

procedure TfTelaHeranca.btnNovoMouseLeave(Sender: TObject);
begin
  btnNovo.Caption := '';
end;

procedure TfTelaHeranca.btnPesquisarMouseEnter(Sender: TObject);
begin
  btnPesquisar.Caption := 'Pesquisar';
end;

procedure TfTelaHeranca.btnPesquisarMouseLeave(Sender: TObject);
begin
  btnPesquisar.Caption := '';
end;

//Controlar botões, dinamica ao clicar em um botão os demais podem ficar desabilitados
procedure TfTelaHeranca.ControlarBotoes(btnNovo, btnAlterar, btnCancelar,
  btnGravar, btnApagar: TSpeedButton; Navegador: TDBNavigator;
  pgcPrincipal: TPageControl; Flag: Boolean);
begin
  btnNovo.Enabled := flag;
  btnApagar.Enabled := flag;
  btnAlterar.Enabled := flag;
  Navegador.Enabled := flag;
  pgcPrincipal.Pages[0].TabVisible := flag;
  btnCancelar.Enabled := not (flag);
  btnGravar.Enabled := not (flag);
end;

// TODA VEZ QUE CLICAR EM NOVO, ELE VAI ME LEVAR NA PAGE MANUTENÇÃO, E AO CLICAR EM CANCELAR, FECHAR OU GRAVAR ELE VAI RETORNAR PARA LISTAGEM
procedure TfTelaHeranca.ControlarIndiceTab(pgcPrincipal: TPageControl;
  indice: integer);
begin
  if (pgcPrincipal.Pages[indice].TabVisible) then
      pgcPrincipal.TabIndex := indice;

end;

// Pegar o titulo da coluna grid, primeira coluna é id, ao clicar na coluna irá aparecer a mensagem ID
procedure TfTelaHeranca.dbgListagemTitleClick(Column: TColumn);
begin
 // ShowMessage(Column.FieldName);  - Informa o nome da coluna após clicar sobre a coluna da grid
 //IndiceAtual := Column.FieldName;
 // desativado no momento, mas talvez eu volte aqui, acrido que tem que ser na minha outra tela
end;

end.
